{% extends 'base.html' %}
{% block content %}





<div id="bus_pick">
  <h3>Pick a Bus Line</h3>

    <ul class="dropdown">
    <form action='/bus_detail', method="get">
    <select name="bus">
    {% for bus in buses %}
    <option value="{{ bus.bus_name }}">{{ bus.bus_name }}</option>
    {% endfor %}
    </select>
    <br><br>
    <input type="submit">
    </form>
    </ul>
</div>


<form action="#">
  <div>
    <input type="hidden" name="datatosendback" id="datatosendback">
  </div>
</form>

  <p class="copy">Just tell me what buses are close by</p>

<div id="geolocation">
<button onclick="showlocation(); delayredir()">Find Me</button>
</div>
<script type="text/javascript">
var lat = null
var long = null

function showlocation() {
   // One-shot position request.
   console.log('clicked');
   navigator.geolocation.getCurrentPosition(callback);
}

function callback(position) {
   lat = position.coords.latitude;
   long = position.coords.longitude
   console.log(lat, long);
   $.get('/stop_info',{'lat': lat, 'long': long})
}



function redirect() { 

window.location="/stop_info?lat=" + lat + "&long=" + long;

} 

 
function delayredir()

{
 
setTimeout('redirect()', 6000);

}

</script>






<!-- ################################################################################ -->

  

{% endblock %}